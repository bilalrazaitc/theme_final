<header class="header__mobile">
  <button type="button" class="header__close">{% render 'icon-close' %}</button>
  <nav class="mobile__nav">
    <ul class="mobile__ul">
      {%- for link in menu -%}
        <li class="mobile__li">
          <a href="{{ link.url }}" class="mobile__link">{{ link.title }}</a>
          {% if link.links != blank %}
            <button type="button" class="mobile--dropdown">{% render 'icon-caret' %}</button>
          {% endif %}
          {% if link.links != blank %}
            <ul class="mobile__ul mobile--child">
              {% for child_link in link.links %}
                <li class="mobile__li">
                  <a href="{{ child_link.url }}" class="mobile__link">{{ child_link.title }}</a>
                  {% if child_link.links != blank %}
                    <button type="button" class="mobile--dropdown">{% render 'icon-caret' %}</button>
                  {% endif %}
                  {% if child_link.links != blank %}
                    <ul class="mobile__ul mobile__grand--child">
                      {% for grand_child_link in link.links %}
                        <li class="mobile__li">
                          <a href="{{ grand_child_link.url }}" class="mobile__link">{{ grand_child_link.title }}</a>
                        </li>
                      {% endfor %}
                    </ul>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        </li>
      {%- endfor -%}
    </ul>
  </nav>
  <a href="/account" class="mobile__account">{% render 'icon-account' %} Account</a>
</header>

<style>
  .mobile__account {
    display: flex;
    height: 50px;
    align-items: center;
    width: calc(100% - 80px);
    margin: 0 auto;
    text-decoration: none
  }
  .mobile__account svg {
    height: 15px;
    margin-right: 8px;
    pointer-events: none;
  }
  .header__mobile {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 400px;
    background: white;
    height: 100%;
    z-index: 2;
    padding-top: 50px;
    left: -400px;
    transition: left 0.25s ease-in-out;
  }
  .header__mobile.active {
    left: 0;
  }
  .header__close {
    position: absolute;
    left: 40px;
    top: 20px;
    height: 30px;
    width: 30px;
    background: none;
    border: 0;
    cursor: pointer;
    text-align: left;
  }
  .header__close svg {
    height: 15px;
  }
  .mobile__nav {
    height: calc(100% - 50px);
    overflow-y: auto;
    padding: 0 40px;
  }
  .mobile__ul {}
  .mobile__li {
    position: relative;
    border-bottom: 1px solid #d9d9d9;
  }
  .mobile__link {
    height: 50px;
    display: flex;
    align-items: center;
    text-decoration: none;
    font-size: 15px;
    text-transform: uppercase;
    padding-right: 40px;
  }
  .mobile--dropdown {
    position: absolute;
    top: 0;
    right: 0;
    width: 40px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    border: 0;
    background: none;
    cursor: pointer;
  }
  .mobile--dropdown svg {
    height: 8px;
    pointer-events: none;
  }
  .mobile--dropdown.active svg {
    transform: rotate(180deg);
  }
  .mobile--child,
  .mobile__grand--child {
    display: none;
  }
  .mobile--child.active,
  .mobile__grand--child.active {
    display: block;
  }
  .mobile--child {
    padding-left: 10px;
    padding-bottom: 10px;
  }
  .mobile__grand--child {
    padding-left: 20px;
    border-left: 1px solid #d9d9d9;
  }
  .mobile--child .mobile__link {
    font-size: 13px;
    text-transform: none;
    height: 40px;
  }
  .mobile--child .mobile__li {
    border-bottom: 0;
  }
  .mobile__grand--child .mobile__link {}
</style>

<script>
  let mobile_dropdowns = document.querySelectorAll(".mobile--dropdown");
  mobile_dropdowns.forEach(dropdown => {
    dropdown.addEventListener("click", e => {
      e.target.classList.toggle("active");
      e
        .target
        .nextElementSibling
        .classList
        .toggle("active");
    });
  });

  let mobile_header = document.querySelector(".header__mobile");
  let mobile_close = document.querySelector(".header__close");
  let mobile_open = document.querySelector(".header__mobile--icon");

  mobile_open.addEventListener("click", e => {
    mobile_header.style.display = "block";
    setTimeout(() => {
      mobile_header.classList.add("active");
    }, 10);
  });
  mobile_close.addEventListener("click", e => {
    mobile_header.classList.remove("active");
    setTimeout(() => {
      mobile_header.style.display = "none";
    }, 260);
  });
</script>